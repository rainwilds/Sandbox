<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <link rel="preload" href="./styles.css" as="style">
    <script src="js/generators/head-generator.js" type="module"></script>

    <data-custom-head data-components="custom-block custom-header" data-title="Advanced Masonry & Scroll Blur"
        data-description="Testing masonry packing with scroll-driven blur effects.">
    </data-custom-head>

    <style>
        @layer components {
            .masonry-container {
                padding: var(--space-large) var(--side-gutter);
                min-height: 200vh;
                background-color: light-dark(var(--color-white), var(--color-dark-6));
            }

            .masonry-grid {
                /* Use the property that Brave currently recognizes */
                display: masonry;

                grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
                gap: var(--space-medium);
                align-items: start;
            }

            .masonry-item {
                background-color: light-dark(var(--color-light-1-alpha-1), var(--color-dark-1-alpha-2));
                border: var(--border-size-small) solid var(--color-light-3);
                padding: var(--space-small);
                border-radius: var(--border-radius-small);

                /* Scroll-Driven Animation */
                view-timeline-name: --card-fade;
                view-timeline-axis: block;

                animation: reveal-and-blur linear both;
                animation-timeline: --card-fade;
                animation-range: entry 10% cover 30%, exit 70% exit 90%;
            }

            @keyframes reveal-and-blur {
                entry 0% {
                    filter: blur(15px);
                    opacity: 0;
                    transform: scale(0.9) translateY(30px);
                }

                entry 100% {
                    filter: blur(0);
                    opacity: 1;
                    transform: scale(1) translateY(0);
                }

                exit 0% {
                    filter: blur(0);
                    opacity: 1;
                    transform: scale(1) translateY(0);
                }

                exit 100% {
                    filter: blur(15px);
                    opacity: 0;
                    transform: scale(0.9) translateY(-30px);
                }
            }

            /* Heights to trigger the masonry packing */
            .masonry-item:nth-child(3n) {
                min-height: 150px;
            }

            .masonry-item:nth-child(3n+1) {
                min-height: 250px;
            }

            .masonry-item:nth-child(3n+2) {
                min-height: 100px;
            }
        }
    </style>
</head>

<body>
    <main>
        <section class="masonry-container">
            <div class="masonry-grid">
                <article class="masonry-item">
                    <h3>Item 1</h3>
                    <p>Entry and exit blur test.</p>
                </article>
                <article class="masonry-item">
                    <h3>Item 2</h3>
                    <p>Masonry will pack this tight.</p>
                </article>
                <article class="masonry-item">
                    <h3>Item 3</h3>
                    <p>Scroll to see me fade.</p>
                </article>
                <article class="masonry-item">
                    <h3>Item 4</h3>
                    <p>Budget data point A.</p>
                </article>

                <article class="masonry-item">
                    <h3>Item 5</h3>
                    <p>Dynamic height content here.</p>
                </article>
                <article class="masonry-item">
                    <h3>Item 6</h3>
                    <p>Brave flag: Masonry Enabled.</p>
                </article>
                <article class="masonry-item">
                    <h3>Item 7</h3>
                    <p>CSS is becoming logic-aware.</p>
                </article>
                <article class="masonry-item">
                    <h3>Item 8</h3>
                    <p>Budget data point B.</p>
                </article>

                <article class="masonry-item">
                    <h3>Item 9</h3>
                    <p>Almost at the bottom.</p>
                </article>
                <article class="masonry-item">
                    <h3>Item 10</h3>
                    <p>Packing logic check.</p>
                </article>
                <article class="masonry-item">
                    <h3>Item 11</h3>
                    <p>Triple the items!</p>
                </article>
                <article class="masonry-item">
                    <h3>Item 12</h3>
                    <p>Final scroll test card.</p>
                </article>
            </div>
        </section>
    </main>
</body>